<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Apple Store üçé</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  background:#fff;
  color:#000;
}
header{
  position:sticky;
  top:0;
  background:#fff;
  padding:14px 20px;
  display:flex;
  justify-content:space-between;
  border-bottom:1px solid #eee;
  z-index:10;
}
header span{cursor:pointer}

section{display:none;animation:fade .4s ease}
section.active{display:block}
@keyframes fade{
  from{opacity:0;transform:translateY(12px)}
  to{opacity:1;transform:none}
}

.hero{text-align:center;padding:60px 20px}

.sale{
  color:#d60000;
  font-weight:600;
  font-size:20px;
  margin-top:10px;
}

.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:20px;
  padding:20px;
}
.card{
  background:#f5f5f7;
  border-radius:28px;
  padding:24px;
  text-align:center;
  transition:.4s;
  cursor:pointer;
}
.card:hover{transform:translateY(-6px)}
.card img{width:140px}

button{
  margin-top:12px;
  padding:12px 22px;
  border-radius:999px;
  border:none;
  background:#0071e3;
  color:#fff;
  font-size:16px;
  cursor:pointer;
}

.options{
  display:flex;
  justify-content:center;
  gap:10px;
  margin:16px 0;
  flex-wrap:wrap;
}
.option{
  padding:10px 16px;
  border-radius:999px;
  border:1px solid #ddd;
  cursor:pointer;
}
.option.active{
  background:#000;
  color:#fff;
}

.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.45);
  display:none;
  align-items:center;
  justify-content:center;
}
.modal{
  background:#fff;
  border-radius:28px;
  padding:24px;
  width:90%;
  max-width:420px;
  animation:fade .3s ease;
}

.receipt{
  background:#f5f5f7;
  border-radius:24px;
  padding:20px;
  margin-top:20px;
}
.receipt-item{
  display:flex;
  justify-content:space-between;
  font-size:14px;
  margin:8px 0;
}
.receipt-total{
  border-top:1px solid #ddd;
  margin-top:12px;
  padding-top:12px;
  font-size:18px;
  font-weight:600;
}
.paid{
  text-align:center;
  color:#1d9f55;
  font-weight:600;
  margin-top:12px;
}
</style>
</head>

<body>

<header>
  <b onclick="show('catalog')">Apple Store</b>
  <span onclick="openCart()">–ö–æ—Ä–∑–∏–Ω–∞ (<span id="count">0</span>)</span>
</header>

<section id="catalog" class="active">
  <div class="hero">
    <h1>iPhone</h1>
    <p class="sale">üî• –°–ö–ò–î–ö–ò 70% –ù–ê –í–°–ï –¢–û–í–ê–†–´!</p>
    <p>–ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å. –ö–∞–∫ –≤—Å–µ–≥–¥–∞.</p>
  </div>

  <div class="grid">
    <div class="card" onclick="openProduct(1)">
      <img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg">
      <h3>iPhone 15 Pro</h3>
      <p>–æ—Ç 35 997 ‚ÇΩ</p>
    </div>
    <div class="card" onclick="openProduct(2)">
      <img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg">
      <h3>iPhone 15</h3>
      <p>–æ—Ç 26 997 ‚ÇΩ</p>
    </div>
  </div>
</section>

<section id="product">
  <div class="hero">
    <h1 id="pName"></h1>
    <img id="pImg" style="width:220px;margin:20px auto;display:block">
    <h2 id="pPrice"></h2>

    <h3>–¶–≤–µ—Ç</h3>
    <div class="options" id="colors"></div>

    <h3>–ü–∞–º—è—Ç—å</h3>
    <div class="options" id="memory"></div>

    <button onclick="add()">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button><br><br>
    <button onclick="show('catalog')">‚Üê –ù–∞–∑–∞–¥</button>
  </div>
</section>

<div id="cart" class="overlay">
  <div class="modal">
    <h2>–ö–æ—Ä–∑–∏–Ω–∞</h2>
    <div id="items"></div>
    <button onclick="checkout()">–û–ø–ª–∞—Ç–∏—Ç—å</button><br><br>
    <button onclick="closeCart()">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>
</div>

<script>
const DISCOUNT = 0.3; // 70% —Å–∫–∏–¥–∫–∞

const products={
  1:{
    name:'iPhone 15 Pro',
    base:Math.round(119990 * DISCOUNT),
    colors:['–ß—ë—Ä–Ω—ã–π','–¢–∏—Ç–∞–Ω','–ë–µ–ª—ã–π'],
    memory:['128 –ì–ë','256 –ì–ë','512 –ì–ë'],
    memoryPrice:{
      '128 –ì–ë':0,
      '256 –ì–ë':Math.round(10000 * DISCOUNT),
      '512 –ì–ë':Math.round(30000 * DISCOUNT)
    },
    image:'https://store.storeimages.cdn-apple.com/4668/as-images.apple.com/is/iphone-15-pro-black'
  },
  2:{
    name:'iPhone 15',
    base:Math.round(89990 * DISCOUNT),
    colors:['–ß—ë—Ä–Ω—ã–π','–°–∏–Ω–∏–π','–†–æ–∑–æ–≤—ã–π'],
    memory:['128 –ì–ë','256 –ì–ë'],
    memoryPrice:{
      '128 –ì–ë':0,
      '256 –ì–ë':Math.round(10000 * DISCOUNT)
    },
    image:'https://store.storeimages.cdn-apple.com/4668/as-images.apple.com/is/iphone-15-black'
  }
};

let current=null, selectedColor='', selectedMemory='';
let cart=JSON.parse(localStorage.getItem('cart')||'[]');

function show(id){
  document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function openProduct(id){
  current=id;
  const p=products[id];
  selectedColor=p.colors[0];
  selectedMemory=p.memory[0];
  pName.innerText=p.name;
  pImg.src=p.image;
  renderOptions('colors',p.colors,v=>selectedColor=v);
  renderOptions('memory',p.memory,v=>{
    selectedMemory=v;
    updatePrice();
  });
  updatePrice();
  show('product');
}

function updatePrice(){
  const p=products[current];
  const price=p.base+p.memoryPrice[selectedMemory];
  pPrice.innerText=price.toLocaleString('ru-RU')+' ‚ÇΩ';
}

function renderOptions(el,arr,cb){
  const box=document.getElementById(el);
  box.innerHTML='';
  arr.forEach((v,i)=>{
    const d=document.createElement('div');
    d.className='option'+(i===0?' active':'');
    d.innerText=v;
    d.onclick=()=>{
      box.querySelectorAll('.option').forEach(o=>o.classList.remove('active'));
      d.classList.add('active');
      cb(v);
    };
    box.appendChild(d);
  });
}

function add(){
  const p=products[current];
  const price=p.base+p.memoryPrice[selectedMemory];
  cart.push({name:p.name,color:selectedColor,memory:selectedMemory,price});
  save();
  alert('–î–æ–±–∞–≤–ª–µ–Ω–æ –≤ –∫–æ—Ä–∑–∏–Ω—É üçé');
}

function save(){
  localStorage.setItem('cart',JSON.stringify(cart));
  count.innerText=cart.length;
}

function openCart(){
  if(!cart.length){
    items.innerHTML='<p>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>';
  }else{
    items.innerHTML=cart.map(p=>`
      <div class="receipt-item">
        <span>${p.name}<br>${p.color}, ${p.memory}</span>
        <span>${p.price.toLocaleString('ru-RU')} ‚ÇΩ</span>
      </div>
    `).join('');
  }
  cartDiv.style.display='flex';
}

function closeCart(){cartDiv.style.display='none';}

function checkout(){
  const total=cart.reduce((s,p)=>s+p.price,0);
  items.innerHTML=`
    <div class="receipt">
      <h3>Apple Store</h3>
      ${cart.map(p=>`
        <div class="receipt-item">
          <span>${p.name}<br>${p.color}, ${p.memory}</span>
          <span>${p.price.toLocaleString('ru-RU')} ‚ÇΩ</span>
        </div>
      `).join('')}
      <div class="receipt-total">
        –ò—Ç–æ–≥–æ: ${total.toLocaleString('ru-RU')} ‚ÇΩ
      </div>
      <div class="paid">‚úî –û–ø–ª–∞—á–µ–Ω–æ</div>
      <div style="text-align:center;font-size:12px;margin-top:8px">
        ${new Date().toLocaleString('ru-RU')}
      </div>
    </div>
  `;
  cart=[];
  save();
}

const cartDiv=document.getElementById('cart');
const items=document.getElementById('items');
save();
</script>

</body>
</html>
