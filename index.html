<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Apple Store</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<link rel="manifest" href="manifest.json">

<style>
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  background:#fff;
  color:#000;
}
header{
  position:sticky;top:0;
  background:#fff;
  padding:14px 20px;
  display:flex;
  justify-content:space-between;
  border-bottom:1px solid #eee;
  z-index:10;
}
.hero{
  text-align:center;
  padding:80px 20px;
}
.hero img{
  width:240px;
  transition:transform .8s cubic-bezier(.4,0,.2,1);
}
.hero.show img{transform:scale(1.05)}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:20px;
  padding:20px;
}
.card{
  background:#f5f5f7;
  border-radius:24px;
  padding:24px;
  text-align:center;
  transition:.6s cubic-bezier(.4,0,.2,1);
}
.card:hover{transform:translateY(-6px)}
.card img{width:140px}
button{
  margin-top:10px;
  padding:12px 22px;
  border-radius:999px;
  border:none;
  background:#0071e3;
  color:#fff;
  font-size:16px;
}
.overlay{
  position:fixed;inset:0;
  background:rgba(0,0,0,.4);
  display:none;
  align-items:center;
  justify-content:center;
}
.modal{
  background:#fff;
  border-radius:28px;
  padding:24px;
  width:90%;
  max-width:420px;
}
.fly{
  position:fixed;
  width:140px;
  z-index:9999;
  transition:1s cubic-bezier(.4,0,.2,1);
  pointer-events:none;
}
</style>
</head>

<body>

<header>
  <b>Apple Store</b>
  <span onclick="openCart()">–ö–æ—Ä–∑–∏–Ω–∞ (<span id="count">0</span>)</span>
</header>

<section class="hero" id="hero">
  <h1>iPhone</h1>
  <img id="heroImg"
    src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg">
</section>

<section class="grid">
  <div class="card">
    <img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg">
    <h3>iPhone 15 Pro</h3>
    <p>119 990 ‚ÇΩ</p>
    <button onclick="add(1)">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
  </div>

  <div class="card">
    <img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg">
    <h3>iPhone 15</h3>
    <p>89 990 ‚ÇΩ</p>
    <button onclick="add(2)">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button>
  </div>
</section>

<div id="cart" class="overlay">
  <div class="modal">
    <h2>–í–∞—à –∑–∞–∫–∞–∑</h2>
    <div id="items"></div>
    <button onclick="checkout()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button><br><br>
    <button onclick="closeCart()">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>
</div>

<script>
/* DATA */
const products={
  1:{name:'iPhone 15 Pro',price:119990},
  2:{name:'iPhone 15',price:89990}
};
let cart=JSON.parse(localStorage.getItem('cart')||'[]');

/* INIT */
updateCount();
setTimeout(()=>hero.classList.add('show'),200);

/* CART */
function save(){
  localStorage.setItem('cart',JSON.stringify(cart));
  updateCount();
}
function updateCount(){
  document.getElementById('count').innerText=cart.length;
}
function add(id){
  cart.push(products[id]);
  save();
  fly();
}
function openCart(){
  const box=document.getElementById('items');
  box.innerHTML='';
  if(cart.length===0){
    box.innerHTML='<p>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>';
  }else{
    cart.forEach(i=>{
      box.innerHTML+=`<p>${i.name}<br>${i.price} ‚ÇΩ</p>`;
    });
    box.innerHTML+=`
      <hr>
      <p><b>–ò—Ç–æ–≥–æ:</b> ${cart.reduce((s,i)=>s+i.price,0)} ‚ÇΩ</p>
    `;
  }
  cartDiv.style.display='flex';
}
function closeCart(){cartDiv.style.display='none'}

/* CHECK */
function checkout(){
  items.innerHTML=`
    <h3>–°–ø–∞—Å–∏–±–æ üçé</h3>
    <p>–ù–æ–º–µ—Ä –∑–∞–∫–∞–∑–∞: APL-${Math.floor(Math.random()*999999)}</p>
    <p>${new Date().toLocaleString()}</p>
    <hr>
    <p><b>–°—É–º–º–∞:</b> ${cart.reduce((s,i)=>s+i.price,0)} ‚ÇΩ</p>
    <p style="color:#777">1375 –ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã—Ö –æ—Ç–∑—ã–≤–æ–≤</p>
  `;
  cart=[];
  save();
}

/* FLY */
function fly(){
  const img=heroImg.cloneNode(true);
  const r=heroImg.getBoundingClientRect();
  img.className='fly';
  img.style.left=r.left+'px';
  img.style.top=r.top+'px';
  document.body.appendChild(img);
  setTimeout(()=>{
    img.style.transform='scale(.1)';
    img.style.opacity='0';
  },10);
  setTimeout(()=>img.remove(),1000);
}

/* PWA */
if('serviceWorker'in navigator){
  navigator.serviceWorker.register('sw.js');
}
</script>

</body>
</html>
