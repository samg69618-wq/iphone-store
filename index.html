<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Apple Store üçé</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  background:#fff;
  color:#000;
}
header{
  position:sticky;
  top:0;
  background:#fff;
  padding:14px 20px;
  display:flex;
  justify-content:space-between;
  border-bottom:1px solid #eee;
  z-index:10;
}
header span{cursor:pointer}

section{display:none;animation:fade .5s ease}
section.active{display:block}
@keyframes fade{
  from{opacity:0;transform:translateY(12px)}
  to{opacity:1;transform:none}
}

.hero{text-align:center;padding:60px 20px}

/* ===== GALLERY ===== */
.gallery{
  position:relative;
  width:280px;
  height:280px;
  margin:0 auto 20px;
}
.gallery img{width:100%}

/* ===== PRICE ANIMATION ===== */
#pPrice{
  font-size:32px;
  transition:.35s ease;
}
.price-animate{
  transform:scale(1.08);
  opacity:.6;
}

/* ===== OPTIONS ===== */
.options{
  display:flex;
  justify-content:center;
  gap:10px;
  margin:16px 0;
  flex-wrap:wrap;
}
.option{
  padding:10px 16px;
  border-radius:999px;
  border:1px solid #ddd;
  cursor:pointer;
}
.option.active{
  background:#000;
  color:#fff;
}

/* ===== QTY ===== */
.qty{
  display:flex;
  justify-content:center;
  align-items:center;
  gap:16px;
  margin:20px 0;
}
.qty button{
  width:36px;
  height:36px;
  border-radius:50%;
  background:#f5f5f7;
  color:#000;
  font-size:20px;
}

/* ===== CART ===== */
.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.45);
  display:none;
  align-items:center;
  justify-content:center;
}
.modal{
  background:#fff;
  border-radius:28px;
  padding:24px;
  width:90%;
  max-width:420px;
}
.cart-row{
  display:flex;
  justify-content:space-between;
  margin:12px 0;
  font-size:15px;
}
.total{
  border-top:1px solid #eee;
  padding-top:12px;
  font-size:18px;
  font-weight:600;
}

/* ===== FLY TO CART ===== */
.fly{
  position:fixed;
  width:80px;
  z-index:999;
  transition:all .8s cubic-bezier(.4,0,.2,1);
  pointer-events:none;
}
</style>
</head>

<body>

<header>
  <b onclick="show('catalog')">Apple Store</b>
  <span onclick="openCart()">–ö–æ—Ä–∑–∏–Ω–∞ (<span id="count">0</span>)</span>
</header>

<section id="catalog" class="active">
  <div class="hero">
    <h1>iPhone</h1>
    <p>–ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å. –ö–∞–∫ –≤—Å–µ–≥–¥–∞.</p>
  </div>

  <div style="display:grid;gap:20px;padding:20px">
    <div onclick="openProduct(1)">iPhone 15 Pro</div>
    <div onclick="openProduct(2)">iPhone 15</div>
    <div onclick="openProduct(3)">iPhone 14</div>
  </div>
</section>

<section id="product">
  <div class="hero">
    <h1 id="pName"></h1>

    <div class="gallery">
      <img id="pImg" src="">
    </div>

    <div id="pPrice"></div>

    <h3>–¶–≤–µ—Ç</h3>
    <div class="options" id="colors"></div>

    <h3>–ü–∞–º—è—Ç—å</h3>
    <div class="options" id="memory"></div>

    <div class="qty">
      <button onclick="qty--,updatePrice()">‚àí</button>
      <b id="qty">1</b>
      <button onclick="qty++,updatePrice()">+</button>
    </div>

    <button onclick="add()">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button><br><br>
    <button onclick="show('catalog')">‚Üê –ù–∞–∑–∞–¥</button>
  </div>
</section>

<div id="cart" class="overlay">
  <div class="modal">
    <h2>–í–∞—à –∑–∞–∫–∞–∑</h2>
    <div id="items"></div>
    <div class="total" id="total"></div>
    <button onclick="checkout()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button><br><br>
    <button onclick="closeCart()">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>
</div>

<script>
const products={
  1:{name:'iPhone 15 Pro',base:119990,colors:['–ß—ë—Ä–Ω—ã–π'],memory:['128 –ì–ë','256 –ì–ë'],memoryPrice:{'128 –ì–ë':0,'256 –ì–ë':10000},img:'https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg'},
  2:{name:'iPhone 15',base:89990,colors:['–°–∏–Ω–∏–π'],memory:['128 –ì–ë','256 –ì–ë'],memoryPrice:{'128 –ì–ë':0,'256 –ì–ë':10000},img:'https://upload.wikimedia.org/wikipedia/commons/a/ab/Apple-logo.png'},
  3:{name:'iPhone 14',base:69990,colors:['–§–∏–æ–ª–µ—Ç–æ–≤—ã–π'],memory:['128 –ì–ë','256 –ì–ë'],memoryPrice:{'128 –ì–ë':0,'256 –ì–ë':8000},img:'https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg'}
};

let current, selectedMemory, qty=1;
let cart=JSON.parse(localStorage.getItem('cart')||'[]');

function show(id){
  document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

function openProduct(id){
  current=id;
  qty=1;
  selectedMemory=products[id].memory[0];
  pName.innerText=products[id].name;
  pImg.src=products[id].img;
  renderOptions('memory',products[id].memory,v=>{selectedMemory=v;updatePrice()});
  updatePrice();
  show('product');
}

function updatePrice(){
  const p=products[current];
  const price=(p.base+p.memoryPrice[selectedMemory])*qty;
  pPrice.classList.add('price-animate');
  setTimeout(()=>pPrice.classList.remove('price-animate'),200);
  pPrice.innerText=price.toLocaleString('ru-RU')+' ‚ÇΩ';
  document.getElementById('qty').innerText=qty;
}

function renderOptions(el,arr,cb){
  const box=document.getElementById(el);
  box.innerHTML='';
  arr.forEach((v,i)=>{
    const d=document.createElement('div');
    d.className='option'+(i===0?' active':'');
    d.innerText=v;
    d.onclick=()=>{
      box.querySelectorAll('.option').forEach(o=>o.classList.remove('active'));
      d.classList.add('active');
      cb(v);
    };
    box.appendChild(d);
  });
}

function add(){
  const p=products[current];
  const price=(p.base+p.memoryPrice[selectedMemory])*qty;
  cart.push({name:p.name,memory:selectedMemory,qty,price});
  localStorage.setItem('cart',JSON.stringify(cart));
  count.innerText=cart.length;

  // FLY
  const img=pImg.cloneNode();
  img.className='fly';
  const r=pImg.getBoundingClientRect();
  img.style.left=r.left+'px';
  img.style.top=r.top+'px';
  document.body.appendChild(img);
  setTimeout(()=>{
    img.style.left='90%';
    img.style.top='10px';
    img.style.opacity=0;
  },10);
  setTimeout(()=>img.remove(),800);
}

function openCart(){
  let sum=0;
  items.innerHTML=cart.map(p=>{
    sum+=p.price;
    return `<div class="cart-row"><span>${p.name} √ó ${p.qty}</span><span>${p.price.toLocaleString('ru-RU')} ‚ÇΩ</span></div>`;
  }).join('');
  total.innerText='–ò—Ç–æ–≥–æ: '+sum.toLocaleString('ru-RU')+' ‚ÇΩ';
  cartDiv.style.display='flex';
}

function closeCart(){cartDiv.style.display='none';}
function checkout(){cart=[];localStorage.clear();location.reload();}

const cartDiv=document.getElementById('cart');
const items=document.getElementById('items');
const total=document.getElementById('total');
count.innerText=cart.length;
</script>

</body>
</html>
