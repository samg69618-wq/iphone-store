<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Apple Store üçé</title>
<meta name="viewport" content="width=device-width, initial-scale=1">

<style>
*{box-sizing:border-box}
body{
  margin:0;
  font-family:-apple-system,BlinkMacSystemFont,sans-serif;
  background:#fff;
  color:#000;
}
header{
  position:sticky;
  top:0;
  background:#fff;
  padding:14px 20px;
  display:flex;
  justify-content:space-between;
  border-bottom:1px solid #eee;
  z-index:10;
}
header span{cursor:pointer}

/* sections */
section{display:none;animation:fade .5s ease}
section.active{display:block}
@keyframes fade{
  from{opacity:0;transform:translateY(12px)}
  to{opacity:1;transform:none}
}

.hero{text-align:center;padding:60px 20px}

/* ===== GALLERY + 3D ===== */
.gallery{
  position:relative;
  width:280px;
  height:280px;
  margin:0 auto 20px;
  perspective:1000px;
}
.gallery-track{
  display:flex;
  height:100%;
  transition:transform .6s cubic-bezier(.4,0,.2,1);
}
.gallery img{
  width:280px;
  flex-shrink:0;
  transition:transform .25s ease;
  transform-style:preserve-3d;
}

/* dots */
.dots{
  display:flex;
  justify-content:center;
  gap:8px;
}
.dot{
  width:8px;
  height:8px;
  border-radius:50%;
  background:#ccc;
}
.dot.active{background:#000}

/* catalog */
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(220px,1fr));
  gap:20px;
  padding:20px;
}
.card{
  background:#f5f5f7;
  border-radius:28px;
  padding:24px;
  text-align:center;
  transition:.4s;
}
.card:hover{transform:translateY(-6px)}
.card img{width:140px}

button{
  margin-top:12px;
  padding:12px 22px;
  border-radius:999px;
  border:none;
  background:#0071e3;
  color:#fff;
  font-size:16px;
  cursor:pointer;
}

/* options */
.options{
  display:flex;
  justify-content:center;
  gap:10px;
  margin:16px 0;
  flex-wrap:wrap;
}
.option{
  padding:10px 16px;
  border-radius:999px;
  border:1px solid #ddd;
  cursor:pointer;
}
.option.active{
  background:#000;
  color:#fff;
}

/* cart */
.overlay{
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.45);
  display:none;
  align-items:center;
  justify-content:center;
}
.modal{
  background:#fff;
  border-radius:28px;
  padding:24px;
  width:90%;
  max-width:420px;
}
</style>
</head>

<body>

<header>
  <b onclick="show('catalog')">Apple Store</b>
  <span onclick="openCart()">–ö–æ—Ä–∑–∏–Ω–∞ (<span id="count">0</span>)</span>
</header>

<!-- CATALOG -->
<section id="catalog" class="active">
  <div class="hero">
    <h1>iPhone</h1>
    <p>–ù–æ–≤—ã–π —É—Ä–æ–≤–µ–Ω—å. –ö–∞–∫ –≤—Å–µ–≥–¥–∞.</p>
  </div>

  <div class="grid">
    <div class="card" onclick="openProduct(1)">
      <img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg">
      <h3>iPhone 15 Pro</h3>
      <p>119 990 ‚ÇΩ</p>
    </div>
    <div class="card" onclick="openProduct(2)">
      <img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg">
      <h3>iPhone 15</h3>
      <p>89 990 ‚ÇΩ</p>
    </div>
    <div class="card" onclick="openProduct(3)">
      <img src="https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg">
      <h3>iPhone 14</h3>
      <p>69 990 ‚ÇΩ</p>
    </div>
  </div>
</section>

<!-- PRODUCT -->
<section id="product">
  <div class="hero">
    <h1 id="pName"></h1>

    <div class="gallery" id="gallery">
      <div class="gallery-track" id="track"></div>
    </div>
    <div class="dots" id="dots"></div>

    <p id="pPrice"></p>

    <h3>–¶–≤–µ—Ç</h3>
    <div class="options" id="colors"></div>

    <h3>–ü–∞–º—è—Ç—å</h3>
    <div class="options" id="memory"></div>

    <button onclick="add()">–î–æ–±–∞–≤–∏—Ç—å –≤ –∫–æ—Ä–∑–∏–Ω—É</button><br><br>
    <button onclick="show('catalog')">‚Üê –ù–∞–∑–∞–¥</button>
  </div>
</section>

<!-- CART -->
<div id="cart" class="overlay">
  <div class="modal">
    <h2>–ö–æ—Ä–∑–∏–Ω–∞</h2>
    <div id="items"></div>
    <button onclick="checkout()">–û—Ñ–æ—Ä–º–∏—Ç—å –∑–∞–∫–∞–∑</button><br><br>
    <button onclick="closeCart()">–ó–∞–∫—Ä—ã—Ç—å</button>
  </div>
</div>

<script>
const products={
  1:{name:'iPhone 15 Pro',price:119990,colors:['–ß—ë—Ä–Ω—ã–π','–¢–∏—Ç–∞–Ω','–ë–µ–ª—ã–π'],memory:['128 –ì–ë','256 –ì–ë','512 –ì–ë'],images:[
    'https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg',
    'https://upload.wikimedia.org/wikipedia/commons/a/ab/Apple-logo.png'
  ]},
  2:{name:'iPhone 15',price:89990,colors:['–ß—ë—Ä–Ω—ã–π','–°–∏–Ω–∏–π','–†–æ–∑–æ–≤—ã–π'],memory:['128 –ì–ë','256 –ì–ë'],images:[
    'https://upload.wikimedia.org/wikipedia/commons/a/ab/Apple-logo.png'
  ]},
  3:{name:'iPhone 14',price:69990,colors:['–ß—ë—Ä–Ω—ã–π','–§–∏–æ–ª–µ—Ç–æ–≤—ã–π'],memory:['128 –ì–ë','256 –ì–ë'],images:[
    'https://upload.wikimedia.org/wikipedia/commons/f/fa/Apple_logo_black.svg'
  ]}
};

let current=null, slide=0, startX=0;
let selectedColor='', selectedMemory='';
let cart=JSON.parse(localStorage.getItem('cart')||'[]');

function show(id){
  document.querySelectorAll('section').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

/* PRODUCT */
function openProduct(id){
  current=id;
  slide=0;
  selectedColor=products[id].colors[0];
  selectedMemory=products[id].memory[0];
  pName.innerText=products[id].name;
  pPrice.innerText=products[id].price+' ‚ÇΩ';
  renderOptions('colors',products[id].colors,v=>selectedColor=v);
  renderOptions('memory',products[id].memory,v=>selectedMemory=v);
  renderGallery(products[id].images);
  show('product');
}

/* GALLERY */
function renderGallery(imgs){
  track.innerHTML='';
  dots.innerHTML='';
  imgs.forEach((src,i)=>{
    track.innerHTML+=`<img src="${src}">`;
    dots.innerHTML+=`<div class="dot ${i===0?'active':''}"></div>`;
  });
  updateSlide();
}
function updateSlide(){
  track.style.transform=`translateX(-${slide*280}px)`;
  document.querySelectorAll('.dot').forEach((d,i)=>d.classList.toggle('active',i===slide));
}

/* SWIPE */
gallery.addEventListener('touchstart',e=>startX=e.touches[0].clientX);
gallery.addEventListener('touchend',e=>{
  const dx=e.changedTouches[0].clientX-startX;
  if(dx<-50 && slide<products[current].images.length-1) slide++;
  if(dx>50 && slide>0) slide--;
  updateSlide();
});

/* 3D ROTATION */
gallery.addEventListener('mousemove',e=>{
  const img=track.children[slide];
  const r=gallery.getBoundingClientRect();
  const x=e.clientX-r.left-r.width/2;
  const y=e.clientY-r.top-r.height/2;
  img.style.transform=`rotateY(${x/15}deg) rotateX(${-y/15}deg)`;
});
gallery.addEventListener('mouseleave',()=>{
  const img=track.children[slide];
  img.style.transform='rotateY(0) rotateX(0)';
});

/* OPTIONS */
function renderOptions(el,arr,cb){
  const box=document.getElementById(el);
  box.innerHTML='';
  arr.forEach((v,i)=>{
    const d=document.createElement('div');
    d.className='option'+(i===0?' active':'');
    d.innerText=v;
    d.onclick=()=>{
      box.querySelectorAll('.option').forEach(o=>o.classList.remove('active'));
      d.classList.add('active');
      cb(v);
    };
    box.appendChild(d);
  });
}

/* CART */
function add(){cart.push({name:products[current].name,price:products[current].price,color:selectedColor,memory:selectedMemory});save();alert('–î–æ–±–∞–≤–ª–µ–Ω–æ üçé');}
function save(){localStorage.setItem('cart',JSON.stringify(cart));count.innerText=cart.length;}
function openCart(){items.innerHTML=cart.length?cart.map((p,i)=>`<p>${p.name}<br>${p.color}, ${p.memory}<br>${p.price} ‚ÇΩ <button onclick="remove(${i})">‚úï</button></p>`).join(''):'<p>–ö–æ—Ä–∑–∏–Ω–∞ –ø—É—Å—Ç–∞</p>';cartDiv.style.display='flex';}
function remove(i){cart.splice(i,1);save();openCart();}
function closeCart(){cartDiv.style.display='none';}
function checkout(){items.innerHTML=`<h3>–°–ø–∞—Å–∏–±–æ üçé</h3><p>–°—É–º–º–∞: ${cart.reduce((s,p)=>s+p.price,0)} ‚ÇΩ</p>`;cart=[];save();}

const cartDiv=document.getElementById('cart');
const items=document.getElementById('items');
save();
</script>

</body>
</html>
